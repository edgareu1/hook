<div class="background-container"><canvas width="375" height="760" class="fish-tank" id="fishtank"></div>
<div style="position: sticky">
<div class="banner text-center">
  <%= image_tag "avatar.jpg", class: "avatar-large", alt: "avatar-large" %>
  <h4 >Welcome <%= current_user.username.capitalize%> !</h4>



      <%= link_to "Create", id: "modal-button", data: { toggle: "modal", target: "#ModalNewLog" }, class: "btn btn-user-box"  do %>
        <h6 style="padding-left: 10px">CREATE LOG</h6>
        <%= image_tag "rod.png", style:"width: 35px" %>
      <% end %>
</div>

  <ul class="location-box">
    <div style="display: flex; justify-content: space-between; align-items: center">
      <%= image_tag "chair.png", style:"width: 30px; padding-bottom: 5px" %>
      <h3 style="font-size: 22px">My Locations</h3>


      <%= link_to "Create", data: { toggle: "modal", target: "#ModalCreateLocation" }, style: "color: #BDEBFF; opacity: 0.7; font-size:12px; padding-bottom: 5px" do %>
        <i class="fas fa-plus" style="font-size: 30px"></i>
      <% end %>
    </div>

    <% if current_user.locations.empty? %>
      <p style="margin: 0">No locations saved yet</p>

    <% else %>
      <% current_user.locations.to_a.sort_by { |location| location.logs.count }.reverse[0..2].each do |location| %>
        <li style="list-style-type: none">
          <div style="display: flex; justify-content: space-between">
            <h6 style="font-size: 16px; margin: 6px 10px 0 0">
              <% if location.logs.count.zero? %>
                (no logs)
              <% elsif location.logs.count == 1%>
                (1 log)
              <% else %>
                <%= "(#{location.logs.count} logs)" %>
              <% end %>

              <strong style="font-size: 18px"><%= location.name.match(/^[^,]*/)[0].truncate(18) %></strong>
            </h6>

            <% weather_data = Rails.configuration.open_weather_api.current lon: location.longitude , lat: location.latitude %>

            <div style="background-image: url(http://openweathermap.org/img/wn/<%= weather_data["weather"][0]["icon"] %>@2x.png); background-position: center; background-repeat: no-repeat; background-size: 58px 58px;-webkit-user-select: none; width: 70px; height: 35px">
            </div>
          </div>

          <h6 style="font-size: 16px; margin-left: 10px; font-weight: 400">- <%= location.site %></h6>
        </li>
      <% end %>
    <% end %>
  </ul>

<!-- Feed box -->

<% feed = [
  'The batfish plays dead when danger is near. It floats motionless on its side when scared, making it look like a dead leaf floating on the surface of the water.',
  #'The word "halibut" means "holy flatfish" (hali=holy + butte=flatfish) because it was only eaten on holy days.',
  #'Most fish reproduce by laying eggs, though some fish, such as great white sharks, give birth to live babies called pups.',
  #'Lungfish can live out of water for several years. It secretes a mucus cocoon and burrows itself under the unbaked earth. It takes in air with its lung through a built-in breathing tube that leads to the surface. A lungfish has both gills and a lung.',
  #'Some fish, such as the great white shark, can raise their body temperature. This helps them hunt for prey in cold water.',
  #'The oldest known age for a fish was an Australian lungfish. In 2003, it was still alive and well at 65 years old.',
  #'Fish use a variety of low-pitched sounds to convey messages to each other. They moan, grunt, croak, boom, hiss, whistle, creak, shriek, and wail. They rattle their bones and gnash their teeth. However, fish do not have vocal chords. They use other parts of their bodies to make noises, such as vibrating muscles against their swim bladder.',
  #'Fish can form schools containing millions of fish. They use their eyes and something called a lateral line to hold their places in the school. The lateral line is a row of pores running along the fish’s sides from head to tail. Special hairs in the pores sense changes in water pressure from the movements of other fish or predators.',
  #'Starfish are not fish. Neither are jellyfish.',
  'Since a fish’s jaw is not attached to its skull, many fishes can shoot their mouths forward like a spring to catch startled prey.',
  #'Electric eels and electric rays have enough electricity to kill a horse.',
  #'Sharks are the only fish that have eyelids.',
  #"Fish have sleep-like periods (lowered response to stimuli, slowed physical activity, and reduced metabolism) but they don't share the same changes in brain waves as humans do when they sleep.",
  'Some fish, such as the herbivorous fish (grazers), often lack jaw teeth but have tooth-like grinding mills in their throats called pharyngeal teeth.',
  #'Most fish have taste buds all over their body.',
  #'An estimated one third of male fish in British waters are changing sex due to pollution in human sewage.',
  #'Saltwater fish need to drink more water than freshwater fish. Since seawater is saltier than the liquids in a fish’s body, water inside the fish is constantly flowing out. If they didn’t drink to replace the lost water, saltwater fish would dry up like prunes.',
  #'The oldest fishhook ever found dates back to about 42,000 years ago.',
  #'Most fish have little salt in them. Sharks, however, have meat as salty as the ocean they live in.',
  #'Most brands of lipstick contain fish scales.',
  #'Most fish can see in color and use colors to camouflage themselves or defend themselves and their territory. Most fish have the best possible eyesight for their habitat and can most certainly see you peering at them in a fish tank. Some fish can see polarized and ultraviolet light.',
  'A fish does not add new scales as it grows, but the scales it has increase in size. In this way, growth rings are formed and the rings reveal the age of a fish.',
  #'Fish that have thin fins with a split tail indicate that they move very quickly or may need them to cover great distances. On the other had, fish that live among rocks and reefs near the ocean floor have broad lateral fin and large tails.',
  #'A ship has a heavy keel in the lower part to keep it from capsizing. Fish, on the other hand, have the keel on top. If the paired fins stop functioning to keep the fish balanced, the fish turns over because its heaviest part tends to sink, which happens when it dies.',
  'On average, flying fish can glide 160 feet (50m), but have been known to glide as far as 660 feet (200 m). And they can reach heights up to 19 feet (6m).',
  #'An inflated porcupine fish can reach a diameter of up to 35 inches (90 cm). It puffs up by swallowing water and then storing it in its stomach. The stomach increases in size with more water. If the fish is taken out of water, it can inflate in a similar way by swallowing air.',
  'A fish can drown in water. Like humans, fish need oxygen, so if there isn’t enough oxygen in the water, they will suffocate.',
  #'Although the fangtooth fish is only a few inches long, it has teeth about the size of a human’s.',
  'The fish in the middle of a school control the school. The fish on the outside are guided by those in the middle. Only bony fish can swim in highly coordinated groups.',
  #'Most fish cannot swim backwards. Those that can are mainly members of one of the eel families.',
  #'Fish would suffocate if they tried to chew because chewing would interfere with water passing over their gills.',
  #'The biggest fish in the world is the giant whale shark, which can grow to nearly 60 feet, or the length of two school buses. It weighs over 25 tons and eats mainly plankton. It has over 4,000 teeth, though they are only 3 mm long.',
  'The most poisonous fish in the world is the stone fish. Its sting can cause shock, paralysis, and even death if not treated within a few hours.',
  #'The word “piranha” is from the Tupi (Brazil) pira nya and means “scissors.” Found in freshwater rivers in South America, piranhas have razor-sharp teeth. They typically eat fish, insects, seeds, fruit, and even larger animals such as horses. While there are no proven reports of piranhas killing a person, they do eat human carcasses.',
  #'The fastest fish is the sailfish. It can swim as fast as a car travels on the highway.',
  #'Seahorses are poor swimmers and can die of exhaustion in stormy waters.',
  #'Seahorses are the only fish that swim upright.',
  #'The slowest fish is a seahorse. It swims so slowly that a person can barely tell it is moving. The slowest is the Dwarf Seahorse, which takes about one hour to travel five feet. It even looks like it is simply standing up, not swimming.',
  #'Some fish do not have scales. Sharks, for example, have rough sandpapery skin instead of scales.',
  #'Fish have multiple Christian and pre-Christian overtones. For example, the Greek word for fish is Ichthys, which is an acronym for “Jesus Christ, God’s Son, Savior” and was used to mark early Christian tombs and meeting places. Because of their association with fertility, fish have also been linked to Isis and Aphrodite.',
  #'In Japan, the fugu, or puffer fish, is a succulent but lethal delicacy. It contains tetrodotoxin, a deadly poison. However, it is so delicious that Japanese gourmets risk their lives to prepare it. To make this high-risk dish, chefs must have a certificate from a special school that teaches preparation of this toxic fish.',
  #'Hammerhead sharks can live in schools of more than 500 sharks. The strongest female swims in the middle. When she is ready to mate, she shakes her head from side to side to signal the other female sharks to move away so she is the center of attention.',
  #'Some desert pupfish can live in hot springs that reach temperatures greater than 113° F.',
  'A male emperor angelfish lives with up to five female mates. If the emperor angelfish dies, one of the females turns into a male fish and becomes the leader of the group.',
  #'The mudskipper is a fish that spends most of its time out of water and can “walk” on its fins. It carries a portable water supply in its gill chambers when it leaves the water. It can also breathe through the pores of its wet skin.',
  'There are approximately 32,000 different kinds of fish in the world today which is more than all the other kinds of vertebrates combined.',
  #'Anableps, four-eyed fish, can see above and below water at the same time.',
  #'Sometimes tornadoes pick up fish while traveling over water and carry them over land, where the fish rain down. These “fish showers” have been happening for thousands of years. Roman writer Pliny the Younger describes this phenomenon in the 1st century A.D.',
  #'Male anglerfish are much smaller than the female. While the female can reach up to 24 inches long, the males barely reach 1.6 inches long and live as parasites on their mates. They stay together for life. As the male ages, he gets smaller and smaller. The female anglerfish’s light is always “on.”',
  'Scientists have explored only 1% of the ocean depths. They believe millions of new kinds of animals and fish are down there, waiting to be discovered.',
  #'Empty dogfish egg cases sometimes wash up onto the beach. Some people call them mermaid purses.',
  #'The entire body of a catfish is covered with taste buds.',
  #'Catfish have over 27,000 taste buds. Humans have around 7,000.',
  #'Humans have been amazed for centuries that salmon, after journeying across the ocean, can find the river where they were born. In the Yukon River in Alaska and in Canada, certain tagged Chinook salmon covered nearly 2,000 miles in 60 days. Salmon also have adapted to live in a variety of aquatic environments, including rivers, lakes, estuaries, coral reefs, and the open sea.',
  'Fish were the first vertebrates with bony skeletons to appear on Earth. Unlike today’s fish, early fish had no scales, fins, or jawbone, but they did have a dorsal fin.',
  #'Hagfish are some of the slimiest animals on earth. An Atlantic hagfish can make enough slime in one minute to fill a bucket.',
  #'Unlike bony fish, sharks and rays do not have swim bladders. They have to swim all the time, even when they are sleeping. Otherwise, they will sink to the bottom of the ocean.',
  #'A seahorse can move each of its eyes separately (one looks forward while the other looks backward). They can also change their color to match their surroundings.',
  #'The term “fish” is used when referring to one species of fish (e.g., 10 salmon are 10 fish). The term “fishes” is used when referring to more than one species (e.g., 10 salmon, 3 trout, and 1 angel fish are 14 fishes).',
  'Unlike most fish, the ocean sunfish does not have a tail. A female sunfish can lay 300 million eggs each year. Each egg is smaller than the period at the end of this sentence.',
  #'Lampreys are jawless and have a round sucker-like mouth.',
  #'Lampreys and hagfish are the most primitive form of fish still living today.',
  #'Most types of seahorses pair for life. Female seahorses lay their eggs inside a pouch on the male seahorse’s belly. When the babies are ready to hatch, the male holds onto a piece of seaweed with his tail and rocks back and forth until the babies pop out of his pouch.',
  #'The freshwater Pygmy and Luzon gobies of the Philippines, the saltwater Marshal Islands goby, and the tiny rice fish from Thailand all reach a maximum length of 1/2", roughly the size of a grain of rice. They are typically considered the world’s smallest fishes.',
  #'A baby seahorse is called a "fry."',
  #'The number of people who fish for sport in America—about 40 million—outnumbers all the country’s golf and tennis players combined.',
]%>

  <ul class="feed">
      <h5 style="text-align:center; padding-top: 10px">Did you know ?</h3>
      <p style="text-align:justify; padding: 0 10px"><%=feed.sample %></p>
  </ul>

    <div class="user-info">
    <div class="user-numbers">
      <div class="info-background">
        <%= current_user.logs.count %>
        <p>LOGS</p>
      </div>
      <div class="info-background">
     <% @array = [] %>
        <% current_user.logs.each do |log|%>
            <% @fish = log.catch_count %>
             <% @array << @fish %>
        <% end %>
           <%=@array.inject(0, &:+)%>
         
        <p>FISH</p>
      </div>
    </div>
  </div>
</div>

<div class="d-flex justify-content-center">
  <ul class="top-fish" style="width: 250px; list-style-type: none; margin-bottom:30px">
      <h5 style="text-align:center">Most caught fish</h3>
      <li class=top-user><p style="text-align:center">1. Fish name - Number of catch</p></li>
      <li class=top-user><p style="text-align:center">2. Fish name - Number of catch</p></li>
      <li class=top-user><p style="text-align:center">3. Fish name - Number of catch</p></li>
  </ul>
  </div>


</div>
</div>



<!-- Modal Create Location Form -->
<div class="modal fade" id="ModalCreateLocation" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
       <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add location</h5>

        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>

      <div class="modal-body">
        <%= render "locations/form", location: Location.new %>
      </div>
    </div>
  </div>
</div>

<!-- Modal Create Log Form -->
<div class="modal fade" id="ModalNewLog" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title" style="color: #010038">New Log</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <%= render "logs/form-new", log: Log.new %>
      </div>
    </div>
  </div>
</div>
